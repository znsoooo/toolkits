更新说明：

在v1.02版推出一段时间后，得到大家需求强烈，但是得到反馈文件标密修改的需求较为丰富，简单的规则替换不能满足所内日益复杂的保密处要求。
所以升级v1.03版，将替换规则由原来的几种模板样式，改为了现在的正则表达式替换。
正则表达式更加通用，如果能够熟悉正则表达式的规则，更可以个性化定制自己需要的文件名替换规则。


软件功能：

软件实现对电脑内的所有不符合密级规范的文档批量进行密级标注的功能。

软件需要配合Everything软件一起使用，如果没有安装的请按照邮件中的安装说明进行安装。


============


Everything安装说明：

Windows XP：右键使用管理员账户运行、安装到D盘、安装过程选择“安装everything服务”和保存数据文件到“安装文件夹”。

Windows 7：如果上述方法不能成功安装，可能需要切换到管理员账户登录后才可安装。

不按如此操作会导致需要在管理员账户下运行程序，才能搜索到结果。


============


标密软件使用说明：


由于Python在遍历系统所有文件时在文件数超过15万时速度变得过于缓慢，而Everything还是一如既往地秒出，所以采用和Everything配合使用的方法进行标密：


1、打开Everything，在搜索窗口输入搜索公式：

1.1 电脑中未标密的文档（公式含义：不匹配路径、匹配指定文件后缀名、文件名中不包含标密文本、不是以~开头的临时文件）：
nopath:<ext:doc;ppt;xls;pps;docx;pptx;xlsx;pdf !公开 !非密 !内部 !秘密 !机密 !startwith:~>

1.2 为按照“密级★年限”标密的文档，搜索修改日期为2020-08-01以后的文件：
nopath:<ext:doc;ppt;xls;pps;docx;pptx;xlsx;pdf 秘密|机密 !★ !startwith:~> dm:>202007


2、多选选中你需要标密的文件，右键选择“复制完整路径和文件名”；


3、打开“自动标密”软件，将复制的文件路径列表粘贴到左侧输入框内；


4、在下方的“匹配”和“替换”输入框内，输入需要替换的正则表达式（“→”左右的内容），修改的文件名列表在右侧实时显示：

4.1 密级增加年限，符合保密标准，举例“重要文件（机密）.txt”改为“重要文件(机密★20年).txt”：
[\(（]秘密[\)）]→(秘密★10年)
[\(（]机密[\)）]→(机密★20年)

4.2 去密级，如“我爱我家（内部）.txt”改为“我爱我家.txt”：
[\(（]([非秘机绝]密)?(内部)?(公开)?[\)）]→

4.3 文件尾部增加后缀，如“我爱我家.txt”改为“我爱我家（内部）.txt”：
$→(内部)

4.4 文件头部增加前缀，如“我爱我家.txt”改为“内部★我爱我家.txt”：
^→内部★

4.5 更多替换规则可根据正则表达式自己自行开发！


5、点击确认，成功后会弹出修改成功的信息、修改成功文件/文件名的数量。


